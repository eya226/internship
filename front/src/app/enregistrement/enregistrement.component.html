<div class="container">
  <!-- Navigation Bar -->
  <nav class="navbar">
    <button routerLink="/secure/ajouter" class="btn-nav">{{ 'records.back_to_list' | translate }}</button>
    <button routerLink="/secure/menu" class="btn-nav">{{ 'records.home' | translate }}</button>
    <button (click)="onPrintFull()" class="btn-nav">{{ 'records.print_all' | translate }}</button>
    <button (click)="onPrintFiltered()" *ngIf="filteredStockages.length > 0" class="btn-nav">{{ 'records.print_filtered' | translate }}</button>
  </nav>

  <!-- Search Section -->
  <div class="search-section">
    <div class="search-container">
      <input id="searchInput"
             [(ngModel)]="searchTerm"
             (input)="applyFilter()"
             [placeholder]="'records.search_placeholder' | translate"
             class="search-input"
      />
      <div class="search-dropdown-toggle" (click)="showSearchOptions = !showSearchOptions">
        {{ getSearchTypeLabel() }}
        <span class="dropdown-arrow">▼</span>
      </div>
      <div *ngIf="showSearchOptions" class="search-dropdown">
        <div (click)="selectSearchType('codeOT')" class="dropdown-item">{{ 'records.code_ot' | translate }}</div>
        <div (click)="selectSearchType('codeITM')" class="dropdown-item">{{ 'records.code_item' | translate }}</div>
        <div (click)="selectSearchType('codeComplet')" class="dropdown-item">{{ 'records.code_complet' | translate }}</div>
        <div (click)="selectSearchType('emplacement')" class="dropdown-item">{{ 'records.code_baguette' | translate }}</div>
        <div (click)="selectSearchType('station')" class="dropdown-item">{{ 'records.station' | translate }}</div>
      </div>
    </div>
  </div>

  <!-- Error Message -->
  <div *ngIf="erreur" class="error-message">
    ⚠️ {{ erreur }}
  </div>

  <!-- Results Table -->
  <div class="table-container">
    <h2>{{ 'records.list_title' | translate }}</h2>
    <table>
      <thead>
        <tr>
          <th>{{ 'records.code_plan' | translate }}</th>
          <th>{{ 'records.code_ot' | translate }}</th>
          <th>{{ 'records.code_item' | translate }}</th>
          <th>{{ 'records.code_baguette' | translate }}</th>
          <th>{{ 'records.station' | translate }}</th>
          <th>{{ 'records.date' | translate }}</th>
          <th>{{ 'records.actions' | translate }}</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let item of displayedStockages">
          <td>{{ item.codeComplet || '-' }}</td>
          <td>{{ item.codeOT }}</td>
          <td>{{ item.codeITM }}</td>
          <td>{{ item.emplacement }}</td>
          <td>{{ item.station }}</td>
          <td>{{ item.dateEnregistrement | date:'short' }}</td>
          <td>
            <button (click)="onModify(item)" class="action-btn modify-btn" [title]="'records.edit' | translate">
              <i class="fas fa-edit"></i>
            </button>
            <button (click)="onDelete(item)" class="action-btn delete-btn" [title]="'records.delete' | translate">
              <i class="fas fa-trash"></i>
            </button>
          </td>
        </tr>
        <tr *ngIf="filteredStockages.length === 0">
          <td colspan="7" class="text-center">
            {{ 'records.no_records' | translate }}
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Pagination -->
  <div *ngIf="totalPages > 1" class="pagination">
    <button 
      *ngFor="let page of [].constructor(totalPages); let i = index"
      (click)="onPageChange(i + 1)"
      [class.active]="currentPage === i + 1">
      {{ i + 1 }}
    </button>
  </div>

  <!-- Footer -->
  <div class="footer-section">
    <p class="footer-text">{{ 'records.footer' | translate }}</p>
  </div>
</div>
