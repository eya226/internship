<div class="container">
  <!-- Navigation Bar -->
  <nav class="navbar">
    <button routerLink="/secure/ajouter" class="btn-nav">{{ 'search_stock.back_to_list' | translate }}</button>
    <button routerLink="/secure/menu" class="btn-nav">{{ 'search_stock.home' | translate }}</button>
    <button (click)="onPrintFullList()" class="btn-nav">{{ 'search_stock.print_all' | translate }}</button>
    <button (click)="onPrintFiltered()" class="btn-nav">{{ 'search_stock.print_filtered' | translate }}</button>
  </nav>

  <!-- Search Section -->
  <div class="search-section">
    <div class="search-container">
      <input id="searchInput"
             [(ngModel)]="searchTerm"
             (input)="applyFilter()"
             [placeholder]="'search_stock.search_placeholder' | translate"
             class="search-input"
      />
      <div class="search-dropdown-toggle" (click)="showSearchOptions = !showSearchOptions">
        {{ getSearchTypeLabel() }}
        <span class="dropdown-arrow">▼</span>
      </div>
      <div *ngIf="showSearchOptions" class="search-dropdown">
        <div (click)="selectSearchType('codeOT')" class="dropdown-item">{{ 'search_stock.code_ot' | translate }}</div>
        <div (click)="selectSearchType('codeITM')" class="dropdown-item">{{ 'search_stock.code_item' | translate }}</div>
        <div (click)="selectSearchType('codeComplet')" class="dropdown-item">{{ 'search_stock.code_complet' | translate }}</div>
        <div (click)="selectSearchType('emplacement')" class="dropdown-item">{{ 'search_stock.code_baguette' | translate }}</div>
        <div (click)="selectSearchType('station')" class="dropdown-item">{{ 'search_stock.station' | translate }}</div>
      </div>
    </div>
  </div>

  <!-- Error Message -->
  <div *ngIf="erreur" class="error-message">
    ⚠️ {{ erreur }}
  </div>

  <!-- Results Table -->
  <div class="table-container">
    <h2>{{ 'search_stock.list_title' | translate }}</h2>
    <table>
      <thead>
        <tr>
          <th>{{ 'search_stock.code_plan' | translate }}</th>
          <th>{{ 'search_stock.code_ot' | translate }}</th>
          <th>{{ 'search_stock.code_item' | translate }}</th>
          <th>{{ 'search_stock.code_baguette' | translate }}</th>
          <th>{{ 'search_stock.station' | translate }}</th>
          <th>{{ 'search_stock.date' | translate }}</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let item of displayedStockages">
          <td>{{ item.codeComplet || '-' }}</td>
          <td>{{ item.codeOT }}</td>
          <td>{{ item.codeITM }}</td>
          <td>{{ item.emplacement }}</td>
          <td>{{ item.station }}</td>
          <td>{{ item.dateEnregistrement | date:'short' }}</td>
        </tr>
        <tr *ngIf="filteredStockages.length === 0">
          <td colspan="6" class="text-center">
            {{ 'search_stock.no_records' | translate }}
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Pagination -->
  <div *ngIf="totalPages > 1" class="pagination">
    <button 
      *ngFor="let page of [].constructor(totalPages); let i = index"
      (click)="onPageChange(i + 1)"
      [class.active]="currentPage === i + 1">
      {{ i + 1 }}
    </button>
  </div>

  <!-- Footer -->
  <div class="footer-section">
    <p class="footer-text">{{ 'search_stock.footer' | translate }}</p>
  </div>
</div>
